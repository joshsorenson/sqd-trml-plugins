{% comment %}
TRMNL Plugin: Linear Issues - Current Cycle & Overdue
Displays Linear issues assigned to you that are due in the current cycle or earlier
{% endcomment %}

<style>
  .priority-badge {
    display: inline-block;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    margin-right: 4px;
  }
  .priority-1 { background: #000; }
  .priority-2 { background: #666; }
  .priority-3 { background: #999; }
  .priority-4 { background: #ccc; }
</style>

<div class="layout layout--top">
  <table class="table" id="linear-issues">
    <thead>
      <tr>
        <th><span class="title title--small">ID</span></th>
        <th><span class="title title--small">Title</span></th>
        <th><span class="title title--small">Status</span></th>
        <th><span class="title title--small">Cycle</span></th>
      </tr>
    </thead>
    <tbody>
      {% for issue in issues %}
      <tr>
        <td>
          <span class="label label--small">
            {% if issue.priority > 0 %}
              <span class="priority-badge priority-{{ issue.priority }}"></span>
            {% endif %}
            {{ issue.identifier }}
          </span>
        </td>
        <td>
          <span class="label label--small">{{ issue.title | truncate: 50 }}</span>
        </td>
        <td>
          <span class="label label--small">{{ issue.status }}</span>
        </td>
        <td>
          <span class="label label--small">{% if issue.cycleNumber %}#{{ issue.cycleNumber }}{% endif %}</span>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div class="title_bar">
  <span class="title">{{ trmnl.plugin_settings.instance_name }}</span>
  <span class="instance">{{ issues | size }} Issues</span>
</div>

<script>
  var issues_table = document.querySelector("#linear-issues");
  if (issues_table.clientHeight >= issues_table.parentNode.clientHeight) {
    issues_table.classList.add("table--condensed");
  }
</script>

